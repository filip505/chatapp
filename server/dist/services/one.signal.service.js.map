{"version":3,"sources":["../../src/main/services/one.signal.service.js"],"names":["OneSignalService","myClient","OneSignal","Client","app","appAuthKey","appId","message","user","personRepository","findOne","id","receiverId","receiver","console","log","oneSignalId","firstNotification","Notification","contents","en","firstName","include_player_ids","sendNotification","err","httpResponse","data"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;;;;;;;IAEMA,gB;;;AAIJ,8BAAc;AAAA;;AAAA,8CAFK,4BAAc,QAAd,CAEL;;AACZ,SAAKC,QAAL,GAAgB,IAAIC,uBAAUC,MAAd,CAAqB;AACnCC,MAAAA,GAAG,EAAE;AACHC,QAAAA,UAAU,EAAE,kDADT;AAEHC,QAAAA,KAAK,EAAE;AAFJ;AAD8B,KAArB,CAAhB;AAMD;;;;;;;+CAEsBC,O,EAASC,I;;;;;;;uBAEP,KAAKC,gBAAL,CAAsBC,OAAtB,CAA8B;AAAEC,kBAAAA,EAAE,EAAEJ,OAAO,CAACK;AAAd,iBAA9B,C;;;AAAjBC,gBAAAA,Q;AACNC,gBAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCP,IAAI,CAACQ,WAAzC;AACIC,gBAAAA,iB,GAAoB,IAAIf,uBAAUgB,YAAd,CAA2B;AACjDC,kBAAAA,QAAQ,EAAE;AAAEC,oBAAAA,EAAE,EAAE,sBAAsBZ,IAAI,CAACa;AAAjC,mBADuC;AAEjDC,kBAAAA,kBAAkB,EAAE,CAACT,QAAQ,CAACG,WAAV;AAF6B,iBAA3B,C;AAKxB,qBAAKf,QAAL,CAAcsB,gBAAd,CAA+BN,iBAA/B,EAAkD,UAAUO,GAAV,EAAeC,YAAf,EAA6BC,IAA7B,EAAmC;AACnF,sBAAIF,GAAJ,EAAS;AACPV,oBAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACD,mBAFD,MAEO;AACLD,oBAAAA,OAAO,CAACC,GAAR,CAAYW,IAAZ;AACD;AACF,iBAND;;;;;;;;;;;;;;;;;;;;;eAWW,IAAI1B,gBAAJ,E","sourcesContent":["import OneSignal from 'onesignal-node'\nimport { getRepository } from 'typeorm'\n\nclass OneSignalService {\n\n  personRepository = getRepository('person')\n\n  constructor() {\n    this.myClient = new OneSignal.Client({\n      app: {\n        appAuthKey: 'MDI4MDAwODUtZjQ2NC00MGFmLTlkYTctNWRhMzlkMDliMjY0',\n        appId: '0596fb61-668e-4d9a-ba3a-3d5a3de4e16a'\n      }\n    });\n  }\n\n  async sendNotification(message, user) {\n\n    const receiver = await this.personRepository.findOne({ id: message.receiverId })\n    console.log('sending notification', user.oneSignalId)\n    var firstNotification = new OneSignal.Notification({\n      contents: { en: 'new message from ' + user.firstName },\n      include_player_ids: [receiver.oneSignalId]\n    });\n\n    this.myClient.sendNotification(firstNotification, function (err, httpResponse, data) {\n      if (err) {\n        console.log('Something went wrong...');\n      } else {\n        console.log(data);\n      }\n    });\n  }\n\n}\n\nexport default new OneSignalService()"],"file":"one.signal.service.js"}